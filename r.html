<html>
  <body>
    <h2>Load library Quantmod pada R</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(quantmod)</code></pre></div>

//ambil data
getSymbols(c("UNVR.JK","BBCA.JK","TLKM.JK","ASII.JK","KLBF.JK","SMRA.JK","ADHI.JK", "ANTM.JK","GGRM.JK", "LPPF.JK"))

//ambil range
unvr.jk = UNVR.JK['2016-01-02::2016-12-24']
bbca.jk = BBCA.JK['2016-01-02::2016-12-24']
tlkm.jk = TLKM.JK['2016-01-02::2016-12-24']
asii.jk = ASII.JK['2016-01-02::2016-12-24']
klbf.jk = KLBF.JK['2016-01-02::2016-12-24']
smra.jk = SMRA.JK['2016-01-02::2016-12-24']
adhi.jk = ADHI.JK['2016-01-02::2016-12-24']
antm.jk = ANTM.JK['2016-01-02::2016-12-24']
ggrm.jk = GGRM.JK['2016-01-02::2016-12-24']
lppf.jk = LPPF.JK['2016-01-02::2016-12-24']

//ambil data adjusted
unvr.jk2 = as.matrix(unvr.jk[,6])
bbca.jk2 = as.matrix(bbca.jk[,6])
tlkm.jk2 = as.matrix(tlkm.jk[,6])
asii.jk2 = as.matrix(asii.jk[,6])
klbf.jk2 = as.matrix(klbf.jk[,6])
smra.jk2 = as.matrix(smra.jk[,6])
adhi.jk2 = as.matrix(adhi.jk[,6])
antm.jk2 = as.matrix(antm.jk[,6])
ggrm.jk2 = as.matrix(ggrm.jk[,6])
lppf.jk2 = as.matrix(lppf.jk[,6])

//ngilangin data NA (not available)
unvr.jk2 = na.omit(unvr.jk2)
attributes(unvr.jk2)$na.action = NULL
bbca.jk2 = na.omit(bbca.jk2)
attributes(bbca.jk2)$na.action = NULL
tlkm.jk2 = na.omit(tlkm.jk2)
attributes(tlkm.jk2)$na.action = NULL
asii.jk2 = na.omit(asii.jk2)
attributes(asii.jk2)$na.action = NULL
klbf.jk2 = na.omit(klbf.jk2)
attributes(klbf.jk2)$na.action = NULL
smra.jk2 = na.omit(smra.jk2)
attributes(smra.jk2)$na.action = NULL
adhi.jk2 = na.omit(adhi.jk2)
attributes(adhi.jk2)$na.action = NULL
antm.jk2 = na.omit(antm.jk2)
attributes(antm.jk2)$na.action = NULL
ggrm.jk2 = na.omit(ggrm.jk2)
attributes(ggrm.jk2)$na.action = NULL
lppf.jk2 = na.omit(lppf.jk2)
attributes(lppf.jk2)$na.action = NULL

//We now go ahead and concatenate columns of data into one stock data set.
//dijadiin satu matriks
stkdata = cbind(unvr.jk2, bbca.jk2, tlkm.jk2, asii.jk2,klbf.jk2,smra.jk2,adhi.jk2,antm.jk2,ggrm.jk2,lppf.jk2)

//ngitung daily returns
n = length(stkdata[,1]) //n = 235, banyak data di masing2 kolom
rets = log(stkdata[2:n,]/stkdata[1:(n-1),])
colMeans(rets) //buat ngitung rata2 masing2 kolom

n = length(stkdata[,1])
rets = log(stkdata[2:n,]/stkdata[1:(n-1),])
colMeans(rets)

//ngitung covariance dan correlation
cv = cov(rets)
print(cv,2) //dua angka di belakang koma
//4.9e-05 = 4.9 x 10^(-5)
cr = cor(rets)
print(cr,2)


cv = cov(rets)
print(cv,2)
cr = cor(rets)
print(cr,2)



//ngitung invers matriks
cv_inv = solve(cv)
print(cv_inv, 3)
print(cv_inv %*% cv, 3) //perkalian matriks biasa, buat ngecek apakah hasilnya adalah I

//ngitung annualized returns
rets_annual = rets * n

r_sd = rep(0,10) //inisialisasi variabel, array 10 indeks yg isinya angka 0
r_sd_annual = rep(0,10) 

rets_annual = rets * n
r_sd = rep(0,10)
r_sd_annual = rep(0,10) 

//ngitung standar deviasi masing2 kolom
for (i in 1:10){
	r_sd[i] = sd(rets[,i])
}

for (i in 1:10){
	r_sd_annual[i] = r_sd[i]*sqrt(n)
}

r_var = rep(0,10)
r_var_annual = rep(0,10)

//ngitung variansi
for (i in 1:10){
	r_var[i] = var(rets[,i])
	r_var_annual[i] = r_var[i]*n
}

//section 3.6, mbuh nggo ngopo
//ngitung sigma dari masing2 kolom
h = 1/n
sigma = rep(0,10)
for (i in 1:10){
	sigma[i] = r_sd[i] / sqrt(h)
}

//mulai ngitung mu
mu = matrix(0,10,1)
for (i in 1:10){
	mu[i,1] = mean(rets[,i])/h + 0.5*sigma[i]^2
}

//mulai ngitung w
rf = 0.005
beta = 4
ones = matrix(1,10,1) //matriks yg elemennya 1 semua

w = (1/beta)*(solve(cv)%*%(mu-rf*ones))
    
    
    
    
  </body>
</html>
